{% extends 'base.html' %}

{% block icon %}<i class="fas fa-user-circle"></i>{% endblock %}
{% block title %}My Profile{% endblock %}

{% block content %}
<div class="row" style="display: flex; gap: 30px; flex-wrap: wrap;">
    <div style="flex: 1; min-width: 300px;">
        <div class="card" style="text-align: center; padding: 40px 20px;">
            <div style="
                width: 100px; 
                height: 100px; 
                margin: 0 auto 20px; 
                background: linear-gradient(135deg, var(--primary), var(--secondary)); 
                border-radius: 50%; 
                display: flex; 
                align-items: center; 
                justify-content: center;
                font-size: 3rem;
                color: white;
                box-shadow: 0 10px 20px rgba(0,0,0,0.2);
            ">
                {{ current_user.username[0]|upper }}
            </div>
            <h2 style="margin-bottom: 5px; color: var(--text-main);">{{ current_user.username }}</h2>
            <p
                style="color: var(--text-muted); text-transform: uppercase; font-size: 0.9rem; letter-spacing: 1px; margin-bottom: 20px;">
                {{ current_user.role }}
            </p>

            <div style="display: flex; justify-content: center; gap: 10px; margin-bottom: 20px;">
                {% if current_user.role == 'teacher' %}
                <span class="badge badge-teacher">Teacher</span>
                {% elif current_user.role == 'student' %}
                <span class="badge badge-student">Student</span>
                {% else %}
                <span class="badge badge-info">Admin</span>
                {% endif %}
            </div>

            {% if current_user.email %}
            <p style="color: var(--text-muted);"><i class="fas fa-envelope"></i> {{ current_user.email }}</p>
            {% endif %}
        </div>
    </div>

    <div style="flex: 2; min-width: 300px;">
        <div class="card">
            <div class="card-header">
                <h3><i class="fas fa-user-edit"></i> Update Profile</h3>
            </div>

            <form action="{{ url_for('main.profile') }}" method="POST">

                <div class="form-group">
                    <label>Username</label>
                    <input type="text" class="form-control" value="{{ current_user.username }}" disabled
                        style="opacity: 0.7; cursor: not-allowed;">
                    <small style="color: var(--text-muted);">Username cannot be changed.</small>
                </div>

                <div class="form-group">
                    <label>Email Address</label>
                    <input type="email" name="email" class="form-control" value="{{ current_user.email or '' }}"
                        placeholder="Enter your email">
                </div>

                <div style="margin: 30px 0; border-top: 1px solid var(--border-color);"></div>

                <h4 style="margin-bottom: 20px; color: var(--text-main);">Change Password</h4>

                <div class="form-group">
                    <label>New Password</label>
                    <input type="password" name="password" class="form-control"
                        placeholder="Leave blank to keep current password">
                </div>

                <div class="form-group">
                    <label>Confirm New Password</label>
                    <input type="password" name="confirm_password" class="form-control"
                        placeholder="Confirm new password">
                </div>

                <button type="submit" class="btn btn-primary" style="margin-top: 20px;">
                    <i class="fas fa-save"></i> Save Changes
                </button>

            </form>
        </div>
    </div>
</div>
{% endblock %}